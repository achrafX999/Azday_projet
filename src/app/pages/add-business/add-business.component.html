<app-header></app-header>

<div class="main-content">
  <form [formGroup]="businessForm" (ngSubmit)="onSubmit()">
    <!-- Conteneur Flex pour aligner la section gauche et la section droite -->
    <div class="form-content">
      <!-- Section gauche -->
      <div class="left-section">
        <h1>List your Business</h1>
        
        <!-- Choisir la catégorie -->
        <div class="form-group">
          <label for="category">Choose Category</label>
          <select id="category" formControlName="category">
            <option value="">Select category</option>
            <option *ngFor="let cat of categories" [value]="cat.id">
              {{ cat.name }}
            </option>
          </select>
        </div>

        <!-- Nom du Business -->
        <div class="form-group">
          <label for="business-name">Business Name</label>
          <input type="text" id="business-name" placeholder="Type here" formControlName="name" />
        </div>

        <!-- Numéro de téléphone -->
        <div class="form-group">
          <label for="phone-number">Phone Number</label>
          <input type="text" id="phone-number" placeholder="Type here" formControlName="phoneNumber" />
        </div>

        <!-- Site web -->
        <div class="form-group">
          <label for="website">Website</label>
          <input type="text" id="website" placeholder="Type here" formControlName="website" />
        </div>

        <!-- Adresse -->
        <div class="form-group">
          <label for="address">Address</label>
          <input type="text" id="address" placeholder="Type here" formControlName="address" />
        </div>

        <!-- Langue (FormArray) -->
        <div class="form-group">
          <label>Language</label>
          <div formArrayName="language">
            <div *ngFor="let langCtrl of language.controls; let i = index">
              <select [formControlName]="i">
                <option value="arabe">arabe</option>
                <option value="francais">francais</option>
                <option value="anglais">anglais</option>
                <option value="espagne">espagne</option>
              </select>
            </div>
          </div>
          <button type="button" class="add-more-btn" (click)="addLanguage()">Add More</button>
        </div>

        <!-- Moyens de paiement (FormArray) -->
        <div class="form-group">
          <label>Add Payment Methods</label>
          <div formArrayName="paymentMethods">
            <div *ngFor="let payCtrl of paymentMethods.controls; let i = index">
              <select [formControlName]="i">
                <option value="Credit Card">Credit Card</option>
                <option value="Cash">Cash</option>
                <option value="PayPal">PayPal</option>
                <option value="Mobile Payment">Mobile Payment</option>
              </select>
            </div>
          </div>
          <button type="button" class="add-more-btn" (click)="addPaymentMethod()">Add More</button>
        </div>

        <!-- Produits et services (FormArray) -->
        <div class="form-group">
          <label>Product & Service</label>
          <div formArrayName="productService">
            <div *ngFor="let prodCtrl of productService.controls; let i = index">
              <input type="text" placeholder="Type here" [formControlName]="i" />
            </div>
          </div>
          <button type="button" class="add-more-btn" (click)="addProductService()">Add More</button>
        </div>

        <!-- Spécialisation (FormArray) -->
        <div class="form-group">
          <label>Specialize</label>
          <div formArrayName="specialize">
            <div *ngFor="let specCtrl of specialize.controls; let i = index">
              <input type="text" placeholder="Type here" [formControlName]="i" />
            </div>
          </div>
          <button type="button" class="add-more-btn" (click)="addSpecialize()">Add More</button>
        </div>

        <!-- Description -->
        <div class="form-group">
          <label for="description">Add Description</label>
          <textarea id="description" rows="4" placeholder="Type here" formControlName="description"></textarea>
        </div>
      </div>
      
      <!-- Section droite -->
      <div class="right-section">
        <!-- Bloc de la carte -->
        <div class="map-container">
          <h3>Location</h3>
          <app-map (locationSelected)="onLocationSelected($event)"></app-map>
        </div>

        <!-- Composant des horaires d'ouverture -->
        <app-opening-hours (openingHoursChanged)="onOpeningHoursChanged($event)"></app-opening-hours>

        <!-- Bloc d'ajout de la photo de profil -->
        <div class="profile-picture">
          <h3>Add Profile Picture</h3>
          <div class="picture-placeholder" (click)="profilePictureInput.click()">
            <img *ngIf="profilePicturePreview; else defaultPlaceholder"
                 [src]="profilePicturePreview"
                 alt="Profile Picture"
                 style="width: 100%; height: 100%; object-fit: cover;" />
            <ng-template #defaultPlaceholder>
              <i class="image-icon"></i>
            </ng-template>
          </div>
          <button type="button" class="add-more-btn" (click)="profilePictureInput.click()">Add More</button>
          <input type="file"
                 #profilePictureInput
                 (change)="onProfilePictureSelected($event)"
                 accept="image/*"
                 hidden />
        </div>

        <!-- Bloc d'ajout d'images supplémentaires -->
        <div class="images">
          <h3>Add Images</h3>
          <div class="images-grid">
            <div class="image-slot" *ngFor="let preview of imagesPreviews; let i = index">
              <div class="image-slot-content">
                <ng-container *ngIf="preview; else defaultIcon">
                  <img [src]="preview" alt="Selected Image" />
                </ng-container>
                <ng-template #defaultIcon>
                  <i class="image-icon"></i>
                </ng-template>
                <input
                  type="file"
                  #fileInput
                  (change)="onImageSelected($event, i)"
                  accept="image/*"
                  class="file-input-overlay"
                />
              </div>
            </div>
            <button type="button" class="add-more-btn" (click)="addMoreImageSlot()">Add More</button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Bouton de soumission placé en dehors du conteneur flex -->
    <div class="upload-button-container">
      <button type="submit" class="upload-btn">Upload Now</button>
    </div>
  </form>
</div>

<app-footer></app-footer>

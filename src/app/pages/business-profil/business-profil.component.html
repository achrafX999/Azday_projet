<app-header></app-header>

<!-- Background + Search Bar -->
<div class="home-content">
  <app-search-bar></app-search-bar>
</div>

<div class="business-card-container">
  <!-- Left Section -->
  <div class="left-section">
    <!-- Logo -->
    <div class="business-logo">
      <img [src]="getProfilePicture(businessData.profile_picture)" alt="Business Logo">
      
    </div>
    
    <!-- Info (name, address, open status, buttons) -->
    <div class="info">
      <!-- Name & Address -->
      <h3>{{ businessData.name }}</h3>
      <p class="address">{{ businessData.address }}</p>
      
      <!-- Open Now & Hours -->
      <p class="open-status">
        <span class="open-now">{{ businessData.is_open ? 'Open Now' : 'Closed' }}</span>
        <a href="#" class="see-all-hours">See all hours</a>
      </p>
      
      <!-- Action Buttons -->
      <div class="actions">
        <button class="btn phone" (click)="togglePhone()">Phone Number</button>
        <button class="btn website" (click)="goToWebsite()">Website</button>
        <button class="btn message">Message</button>
        <button class="btn direction">Get Direction</button>
      </div>
      <!-- Affichage conditionnel du numéro de téléphone -->
        <div *ngIf="showPhone" class="phone-display">
          {{ businessData.phone_number }}
        </div>
    </div>
  </div>

  <!-- Right Section -->
  <div class="right-section">
    <!-- Icons (Heart, Share, Print) -->
    <div class="icon-actions">
      <span class="icon heart"
            title="Helpful"
            [ngClass]="{'clicked': helpfulClicked}"
            (click)="onHelpfulClick()">
      </span>
      <span class="icon share"
            title="Share"
            (click)="onShareClick()">
      </span>
      <span class="icon print"
            title="Report"
            [ngClass]="{'clicked': reportClicked}"
            (click)="onReportClick()">
      </span>
    </div>
    
    

    <!-- Rating & Reviews -->
    <div class="rating-reviews">
      <div class="stars">
        <span class="star filled"></span>
        <span class="star filled"></span>
        <span class="star filled"></span>
        <span class="star filled"></span>
        <span class="star filled"></span>
      </div>
      <span class="review-count">({{ businessData.reviewCount || 70 }})</span>
      <a href="#" class="read-reviews">Read Reviews</a>
    </div>
  </div>
</div>

<div class="combined-section">
  <!-- Colonne de gauche : Détails + (Produits / Spécialités) -->
  <div class="details-section">
    <h2>Details & Description</h2>
    <p>{{ businessData.description }}</p>

    <!-- On regroupe "Products and Services" et "Specialties" dans un conteneur flex -->
    <div class="products-specialties">
      <div class="products">
        <h2>Products and Services</h2>
        <ul>
          <li *ngFor="let service of businessData.product_services">{{ service }}</li>
        </ul>
      </div>
      <div class="specialties">
        <h2>Specialties</h2>
        <ul>
          <li *ngFor="let specialty of businessData.specialize">{{ specialty }}</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Colonne de droite : Map + Adresse -->
  <div class="location-section">
    <h2>Location</h2>
    <a href="#" class="view-map">View Map</a>
    <app-map *ngIf="businessData && businessData.latitude && businessData.longitude"
    [latitude]="businessData.latitude" 
    [longitude]="businessData.longitude" 
    [selectable]="false">
</app-map>
<p class="address">{{ businessData.address }}</p>
  </div>
</div>

<!-- Galerie d'images en dessous -->
<div class="gallery-container">
  <h2>Gallery</h2>
  <div class="gallery">
    <img
      *ngFor="let img of businessData.images"
      [src]="getGalleryImageUrl(img.image)"
      alt="Business Gallery Image"
    />
  </div>
</div>

<!-- Nouvelle section pour Languages, Payment, Opening Hours -->
<div class="additional-info-container">
  <!-- Bloc 1 : Languages -->
  <div class="info-section languages">
    <h4>Languages Spoken</h4>
    <ul>
      <li *ngFor="let item of businessData.languages | keyvalue">
        {{ item.value }}
      </li>
    </ul>
  </div>

  <!-- Bloc 2 : Methods of Payment -->
  <div class="info-section payment">
    <h4>Methods of Payment</h4>
    <ul>
      <li *ngFor="let item of businessData.payment_methods | keyvalue">
        {{ item.value }}
      </li>
    </ul>
  </div>

  <!-- Bloc 3 : Opening Hours -->
  <div class="info-section opening-hours">
    <h4>Opening Hours</h4>
    <div class="opening-hour-dropdown">
      <!-- Dropdown existant -->
      <div class="selected-day" (click)="toggleDropdown($event)">
        <span class="day-text">
          {{ daysOfWeek[selectedDayIndex] }} 
          {{ transformTimeToAmPm(getOpenCloseTime(daysOfWeek[selectedDayIndex]).open) }} 
          - 
          {{ transformTimeToAmPm(getOpenCloseTime(daysOfWeek[selectedDayIndex]).close) }}
        </span>
        <span class="chevron"></span>
      </div>
      <div class="dropdown-menu" *ngIf="showDropdown">
        <div class="dropdown-item" 
             *ngFor="let day of daysOfWeek; let i = index" 
             (click)="selectDay(i)">
          {{ day }} 
          {{ transformTimeToAmPm(getOpenCloseTime(day).open) }} - 
          {{ transformTimeToAmPm(getOpenCloseTime(day).close) }}
        </div>
      </div>
      
    </div>
  </div>
</div>


<div class="review-section">
  <!-- Les sections de reviews peuvent être également rendues dynamiquement -->
  <!-- ... contenu des reviews ... -->
</div>


<div class="review-section">
  <!-- Review Content -->
  <div class="review-container">
    <div class="review-summary">
        <h3>Summary</h3>
        <div class="rating-bars">
            <div class="rating-row">
                <span>5</span>
                <div class="bar"><div class="fill" style="width: 80%;"></div></div>
            </div>
            <div class="rating-row">
                <span>4</span>
                <div class="bar"><div class="fill" style="width: 50%;"></div></div>
            </div>
            <div class="rating-row">
                <span>3</span>
                <div class="bar"><div class="fill" style="width: 30%;"></div></div>
            </div>
            <div class="rating-row">
                <span>2</span>
                <div class="bar"><div class="fill" style="width: 20%;"></div></div>
            </div>
            <div class="rating-row">
                <span>1</span>
                <div class="bar"><div class="fill" style="width: 10%;"></div></div>
            </div>
        </div>

        <div class="overall-rating">
            <span class="rating-value">4.5 ★</span>
            <span class="review-count">273 Reviews</span>
        </div>

        <div class="recommendation">
            <strong>88%</strong> Recommended
        </div>
    </div>

    <div class="review-info">
        <p>Product reviews are managed by a third party to verify authenticity and compliance with our 
            <a href="#">Ratings & Reviews Guidelines</a>.
        </p>
        <button class="write-review">Write a review</button>
    </div>
</div>

<div class="customer-reviews">
  <!-- Review 1 -->
  <div class="review">
    <div class="review-header">
      <span class="username">mari0865</span>
    </div>
    <div class="review-content">
      <p>
        I had a leaking basement and George from Royal Plumbing came right away to my home to investigate. He was very professional and was able to determine the root cause and did an amazing job to resolve the issue. I would strongly recommend him and Royal Plumbing to friends and family, and I will definitely request for their services again should I need it. Thank you very much George!
      </p>
    </div>
  </div>

  <!-- Review 2 -->
  <div class="review">
    <div class="review-header">
      <span class="username">nico3293</span>
    </div>
    <div class="review-content">
      <p>
        Last want to thank Royal Plumbing on their super fast service. Joe was amazingly quick at snaking a pipe in my kitchen. I would and will recommend them to anyone!
      </p>
    </div>
  </div>

  <!-- Review 3 -->
  <div class="review">
    <div class="review-header">
      <span class="username">user1234</span>
    </div>
    <div class="review-content">
      <p>
        The team at Royal Plumbers was very professional. They were on time, installed my new sink, and kept the kitchen area clean. Thanks!
      </p>
    </div>
  </div>
</div>

  

<app-footer></app-footer>
